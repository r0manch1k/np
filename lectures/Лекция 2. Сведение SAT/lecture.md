# Лекция 2. Сведение SAT

_Лекция написана студентом Соколовским Романом Вадимовичом из группы Б9123-01.03.02сп под руководством преподавателя Месенёва Павла Ростиславовича_

_В приведённом ниже материале используются термины и обозначения, введённые в [Лекции 1. Введение в NP](./../Лекция%201.%20Введение%20в%20NP/lecture.md)_

### Содержание

1. Полнота SAT
1. Сведение 3SAT к 3СOLOR
1. Источники

## 1. Полнота SAT

Проблема выполнимости, обозначаемая $SAT$, формулируется следующим образом: задана логическая формула $\phi$; определить, является ли она выполнимой. Очевидно, что $SAT \in NP$, т.к. удовлетворяющий набор переменных - это сертфикат $y$, и то, что $y$ действительно является удовлетворяющим набором переменных для $\phi$, может быть проверено за полиномиальное время.

Для начала стоит доказать, что $SAT$ является $NP$-Полной задачей, показав, что для каждого языка в $NP$ существует полиномиальное сведение к $SAT$. Тогда мы сможем утверждать, что любая задача, к которой сводится $SAT$ является $NP$-Полной. Почему это работает объяснено в [Лекции 1. Введение в NP](./../Лекция%201.%20Введение%20в%20NP/lecture.md).

**Теорема (С. Кук, Л. Левин).** $SAT$ является $NP$-Полной задачей.

> **Доказательство.** Рассмотрим только часть доказательства, так как это не основная тема лекции, а полная версия очень громоздкая.
>
> Рассмотрим задачу $A \in NP$. Она решается недетерминированной машиной Тьюринга $\mathfrak{M}$. Для удобства будет предполагать, что лента $\mathfrak{M}$ может увеличиваться бесконечно только вправо. Из определения $NP$, машина $\mathfrak{M}$ совершает не более $n^k$ шагов для успешного выполнения; мы можем утверждать, что длина ленты при вводе входных данных $x$ длины $n$ и далее на каждом шаге не превысит $n^k$, т.к. изначально головка $\mathfrak{M}$ стоит в начале ленты, двигается за один шаг максимум на одну ячейку вправо или влево и может в худшем случае сделать $n^k$ шагов вправо.
>
> Построим таблицу для данной $\mathfrak{M}$ и входных данных $x$. Пусть строки - это конфигурации машины (вид ленты) на кажом шаге, а столбцы - символы в соответсвутющей ячейке на каждом шаге. Для удобства доказательства в начало и конец ленты добавляют символ $\\#$. Вместе с символом состояния размер таблицы получается $(n^k + 3) \times (n^k + 3)$, но для удобства будем считать, что $n^k \times n^k$. Первая строка (стартовая конфигурация) имеет вид $(1)$:
>
> $$
> \begin{align*}
> \\# \ q_0 \ x_1 \ x_2 \ \ldots \ x_n \ \sqcup \ \ldots \ \sqcup \ \\# \\
> \longleftarrow n^k \longrightarrow
> \end{align*}
> $$
>
> Каждая следующая строка таблицы строится из предыдущей согласно правилам перехода в $\mathfrak{M}$.
>
> Таблица, построенная по этому приницпу, называется _принимающей_, если каждая строка является _принимающей_ конфигурацией. Иначе говоря, каждая принимающая таблица для $\mathfrak{M}$, построенная на входных данных $x$, соответствует успешному выполнению (одной из угаданных недетерминированной машиной ветке) при входных данных $x$. Таким, образом, задача определения того, принимает ли $\mathfrak{M}$ $x$, эквивалентна задаче определения того, существует ли принимающая таблица для $\mathfrak{M}$ на $x$.
>
> Далее строится булева формула $\phi$, разрешимость которой будет говорить о том, что таблица построенная на $\mathfrak{M}$ и $x$ является принимающей. Данная формула имеет вид:
>
> $$
> \phi = \phi_{cell} \wedge \phi_{start} \wedge \phi_{move} \wedge \phi_{accept}
> $$
>
> Здесь $\phi_{cell}$ требует, чтобы каждой ячейке в таблице соответствовала ровно одна переменная в формуле $\phi$; условие $\phi_{start}$ проверяет, чтобы стартовая конфигурация имела вид $(1)$; формула $\phi_{move}$ гарантирует, что все строки таблицы соответствуют правилам перехода $\mathfrak{M}$ и, наконец, $\phi_{accept}$ проверяет наличие состояния $q_F$ в последней строке. Вид самих формул опустим.
>
> Мы свели изначальный алгоритм проверки $x \in A$ к булевой формуле $\phi$. Теперь необходимо оценить количество переменных в формуле и время генерации этой формулы. Это мы также опустим и поверим, что $\phi$ строится за полиномиальное время на основе входных данных $x$.
>
> Таким образом, для каждого языка из $NP$ существует полиномиальное сведение к $SAT$. Следовательно, $SAT$ является $NP$-Полной задачей. ✌️

Всё это хорошо, но $SAT$ в некоторых случаях не очень удобен для сведения его к другим задачам, в отличии от его частного случая - $3SAT$. Формулы $3SAT$ являются КНФ с тремя переменными в одном клозе. Покажем, что $3SAT$ является $NP$-Полной задачей, путём доказательства существования полиномиального сведения $SAT$ к $3SAT$.

**Теорема (Г. Цейтин).** Для каждой булевой формулы $\phi$ существует равновыполнимая $3КНФ$ формула $\psi$, которая может быть вычислена за полиномиальное время.

> **Замечание.** _Равновыполнимость_ значит, что $\phi$ выполнима тогда и только тогда, когда $\psi$ выполнима (либо они обе удовлетворимые либо обе нет). Это более слабое условие в отличие от эквивалентности. Построить эквивалетную $3КНФ$ формулу не всегда представляется возможным или её построение может вести к экспоненциальному времени.

> **Доказательство (Трансформация Цейтина).** Для каждой подформулы (кроме простых переменных) $\xi_i$ у $\phi$ мы вводим новую переменную $t_i$ и соединяем её с этой подформулой эквивалентностью: $t_i \leftrightarrow \xi_i$. Например, для формулы $(p \rightarrow q) \vee (q \rightarrow (p \rightarrow q))$ полученные эквивалентнсти имеют вид:
>
> $$
> \begin{align*}
> t_1 \rightarrow (p \rightarrow q) \\
> t_2 \rightarrow (p \rightarrow r) \\
> t_3 \rightarrow (q \rightarrow t_2) \\
> t_4 \rightarrow (t_1 \vee t_3)
> \end{align*}
> $$
>
> Пусть последняя эквивалентность $t_n$ (в примере $n = 4$) соответсвует формуле $\phi$. Тогда коньюнкция всех эквивалентностей плюс t_n будет равновыполнима с $\phi$. То есть для нашего примера $\phi \equiv t_4 \wedge t_4 (\rightarrow (t_1 \vee t_3)) \wedge (t_3 \rightarrow (q \rightarrow t_2)) \wedge (t_2 \rightarrow (p \rightarrow r)) \wedge (t_1 \rightarrow (p \rightarrow q))$. После раскрытия эквивалентностей получил КНФ формулу с не более чем тремя переменными в одном клозе.

Таким образом, $SAT \leq_P 3SAT$ и $3SAT$ является $NP$-Полной задачей.

## 2. Сведение 3SAT к 3COLOR

Многие сведения используют так называемые _гаджеты_. Определённые части задачи трансформируются в соответсвующие гаджеты, которые впоследствии соединяются для решения задачи.
